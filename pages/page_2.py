import streamlit as st
import pandas as pd
import numpy as np

# Создаем DataFrame с пустыми значениями нужного размера
df = pd.DataFrame(index=range(33), columns=range(25))

# Заполняем заголовки и метаданные
df.iloc[0:3, 0:25] = ''

# Устанавливаем заголовки (как в файле)
df.iloc[2, 2] = 'з24'
df.iloc[2, 5] = 'л24'
df.iloc[2, 9] = 'з25'
df.iloc[2, 13] = 'л25'
df.iloc[2, 18] = 'фактическое з26'
df.iloc[2, 23] = 'от фактического з26'

# Заполняем строку с подзаголовками
headers = ['', '', 'ФОТ', 'На руках', '', 'ФОТ', 'На руках', 'Прибавка на руках', '', 
           'ФОТ', 'На руках', 'Прибавка на руках', '', 'ФОТ', 'На руках', 
           'Прибавка на руках', 'В год', '', 'ФОТ', 'На руках', 'Прибавка на руках', 
           '', '=T7', '', '']
for i, val in enumerate(headers):
    df.iloc[3, i] = val

# Данные и формулы для каждой строки
data_rows = [
    # Код, Должность, ФОТ з24, формула на руки, ... и т.д.
    ['ИП 1', 'Инженер проектировщик 1 категории', 89051.03, '=C4*0.87', '', '=C4*1.055', '=F4*0.87', '=G4-D4', '', 
     '=F4*1.055', '=J4*0.87', '=K4-G4', '', '=J4*1.055', '=N4*0.87', '=O4-K4', '=O4*12', '', 
     '=N4*1.055', '=S4*0.87', '=T4-O4', '', '=W$3-T4', '=ROUND((W4*100)/T4,1)&" %"', '=$A4'],
    
    ['ИП 2', 'Инженер проектировщик 2 категории', 83157.43, '=C5*0.87', '', '=C5*1.055', '=F5*0.87', '=G5-D5', '', 
     '=F5*1.055', '=J5*0.87', '=K5-G5', '', '=J5*1.055', '=N5*0.87', '=O5-K5', '=O5*12', '', 
     '=N5*1.055', '=S5*0.87', '=T5-O5', '', '=W$3-T5', '=ROUND((W5*100)/T5,1)&" %"', '=$A5'],
    
    ['ВИП', 'Ведущий инженер проектировщик', 115141.32, '=C6*0.87', '', '=C6*1.055', '=F6*0.87', '=G6-D6', '', 
     '=F6*1.055', '=J6*0.87', '=K6-G6', '', '=J6*1.055', '=N6*0.87', '=O6-K6', '=O6*12', '', 
     '=N6*1.055', '=S6*0.87', '=T6-O6', '', '=W$3-T6', '=ROUND((W6*100)/T6,1)&" %"', '=$A6'],
    
    ['ГИП', 'Главный инженер проектировщик', 127934.43, '=C7*0.87', '', '=C7*1.055', '=F7*0.87', '=G7-D7', '', 
     '=F7*1.055', '=J7*0.87', '=K7-G7', '', '=J7*1.055', '=N7*0.87', '=O7-K7', '=O7*12', '', 
     '=N7*1.055', '=S7*0.87', '=T7-O7', '', '=W$3-T7', '=ROUND((W7*100)/T7,1)&" %"', '=$A7'],
    
    ['ВИК', 'Ведущий инженер конструктор', 100000, '=C8*0.87', '', '=C8*1.055', '=F8*0.87', '=G8-D8', '', 
     '=F8*1.055', '=J8*0.87', '=K8-G8', '', '=J8*1.055', '=N8*0.87', '=O8-K8', '=O8*12', '', 
     '=N8*1.055', '=S8*0.87', '=T8-O8', '', '=W$3-T8', '=ROUND((W8*100)/T8,1)&" %"', '=$A8'],
    
    ['ИК 2', 'Инженер конструктор 2 категории', 76765.34, '=C9*0.87', '', '=C9*1.055', '=F9*0.87', '=G9-D9', '', 
     '=F9*1.055', '=J9*0.87', '=K9-G9', '', '=J9*1.055', '=N9*0.87', '=O9-K9', '=O9*12', '', 
     '=N9*1.055', '=S9*0.87', '=T9-O9', '', '=W$3-T9', '=ROUND((W9*100)/T9,1)&" %"', '=$A9'],
    
    ['ИК 1', 'Инженер конструктор 1 категории', 90948.37, '=C10*0.87', '', '=C10*1.055', '=F10*0.87', '=G10-D10', '', 
     '=F10*1.055', '=J10*0.87', '=K10-G10', '', '=J10*1.055', '=N10*0.87', '=O10-K10', '=O10*12', '', 
     '=N10*1.055', '=S10*0.87', '=T10-O10', '', '=W$3-T10', '=ROUND((W10*100)/T10,1)&" %"', '=$A10'],
    
    ['ГК', 'Главный конструктор', np.nan, np.nan, '', np.nan, np.nan, np.nan, '', 
     np.nan, np.nan, np.nan, '', 115000, '=N11*0.87', '', '=O11*12', '', 
     '=N11*1.055', '=S11*0.87', '=T11-O11', '', '=W$3-T11', '=ROUND((W11*100)/T11,1)&" %"', '=$A11'],
    
    ['', '', np.nan, np.nan, '', np.nan, np.nan, np.nan, '', 
     np.nan, np.nan, np.nan, '', np.nan, np.nan, np.nan, np.nan, '', 
     np.nan, np.nan, np.nan, '', np.nan, np.nan, np.nan],
    
    ['ТД', 'Технический директор', 172711.44, '=C13*0.87', '', '=C13*1.055', '=F13*0.87', '=G13-D13', '', 
     '=F13*1.055', '=J13*0.87', '=K13-G13', '', '=J13*1.055', '=N13*0.87', '=O13-K13', '=O13*12', '', 
     '=N13*1.055', '=S13*0.87', '=T13-O13', '', '=W$3-T13', '=ROUND((W13*100)/T13,1)&" %"', '=$A13'],
    
    ['ГД', 'Гениральный директор', 333907.5, '=C14*0.87', '', '=C14*1.055', '=F14*0.87', '=G14-D14', '', 
     '=F14*1.055', '=J14*0.87', '=K14-G14', '', '=J14*1.055', '=N14*0.87', '=O14-K14', '=O14*12', '', 
     '=N14*1.055', '=S14*0.87', '=T14-O14', '', '=W$3-T14', '=ROUND((W14*100)/T14,1)&" %"', '=$A14'],
    
    ['ИГД', 'Исполняющий обязанности генирального директора', 267126.6, '=C15*0.87', '', '=C15*1.055', '=F15*0.87', '=G15-D15', '', 
     '=F15*1.055', '=J15*0.87', '=K15-G15', '', '=J15*1.055', '=N15*0.87', '=O15-K15', '=O15*12', '', 
     '=N15*1.055', '=S15*0.87', '=T15-O15', '', '=W$3-T15', '=ROUND((W15*100)/T15,1)&" %"', '=$A15'],
    
    ['', '', np.nan, np.nan, '', np.nan, np.nan, np.nan, '', 
     np.nan, np.nan, np.nan, '', np.nan, np.nan, np.nan, np.nan, '', 
     np.nan, np.nan, np.nan, '', np.nan, np.nan, np.nan],
    
    ['ГИП', 'Главный инженер проекта', 145518.26, '=C17*0.87', '', '=C17*1.055', '=F17*0.87', '=G17-D17', '', 
     '=F17*1.055', '=J17*0.87', '=K17-G17', '', '=J17*1.055', '=N17*0.87', '=O17-K17', '=O17*12', '', 
     '=N17*1.055', '=S17*0.87', '=T17-O17', '', '=W$3-T17', '=ROUND((W17*100)/T17,1)&" %"', '=$A17'],
    
    ['ГАП', 'Главный архитектор проекта', 128735.63, '=C18*0.87', '', '=C18*1.055', '=F18*0.87', '=G18-D18', '', 
     '=F18*1.055', '=J18*0.87', '=K18-G18', '', '=J18*1.055', '=N18*0.87', '=O18-K18', '=O18*12', '', 
     '=N18*1.055', '=S18*0.87', '=T18-O18', '', '=W$3-T18', '=ROUND((W18*100)/T18,1)&" %"', '=$A18'],
    
    ['ГА', 'Главный архитектор', 114942.53, '=C19*0.87', '', '=C19*1.055', '=F19*0.87', '=G19-D19', '', 
     '=F19*1.055', '=J19*0.87', '=K19-G19', '', '=J19*1.055', '=N19*0.87', '=O19-K19', '=O19*12', '', 
     '=N19*1.055', '=S19*0.87', '=T19-O19', '', '=W$3-T19', '=ROUND((W19*100)/T19,1)&" %"', '=$A19'],
    
    ['', '', np.nan, np.nan, '', np.nan, np.nan, np.nan, '', 
     np.nan, np.nan, np.nan, '', np.nan, np.nan, np.nan, np.nan, '', 
     np.nan, np.nan, np.nan, '', np.nan, np.nan, np.nan],
    
    ['', '', np.nan, np.nan, '', np.nan, np.nan, np.nan, '', 
     np.nan, np.nan, np.nan, '', np.nan, np.nan, np.nan, np.nan, '', 
     np.nan, np.nan, np.nan, '', np.nan, np.nan, np.nan],
    
    ['ВА', 'Ведущий архитектор', 95950.54, '=C22*0.87', '', '=C22*1.055', '=F22*0.87', '=G22-D22', '', 
     '=F22*1.055', '=J22*0.87', '=K22-G22', '', '=J22*1.055', '=N22*0.87', '=O22-K22', '=O22*12', '', 
     '=N22*1.055', '=S22*0.87', '=T22-O22', '', '=W$3-T22', '=ROUND((W22*100)/T22,1)&" %"', '=$A22'],
    
    ['РО', 'Руководитель отдела', 100000, '=C23*0.87', '', '=C23*1.055', '=F23*0.87', '=G23-D23', '', 
     '=C23*1.055', '=J23*0.87', '=K23-G23', '', '=J23*1.055', '=N23*0.87', '=O23-K23', '=O23*12', '', 
     '=N23*1.055', '=S23*0.87', '=T23-O23', '', '=W$3-T23', '=ROUND((W23*100)/T23,1)&" %"', '=$A23'],
    
    ['ВИ', 'Ведущий инженер', 95950.54, '=C24*0.87', '', '=C24*1.055', '=F24*0.87', '=G24-D24', '', 
     '=F24*1.055', '=J24*0.87', '=K24-G24', '', '=J24*1.055', '=N24*0.87', '=O24-K24', '=O24*12', '', 
     '=N24*1.055', '=S24*0.87', '=T24-O24', '', '=W$3-T24', '=ROUND((W24*100)/T24,1)&" %"', '=$A24'],
    
    ['А 2', 'Архитектор 2 категории', 54570.45, '=C25*0.87', '', '=C25*1.055', '=F25*0.87', '=G25-D25', '', 
     '=F25*1.055', '=J25*0.87', '=K25-G25', '', '=J25*1.055', '=N25*0.87', '=O25-K25', '=O25*12', '', 
     '=N25*1.055', '=S25*0.87', '=T25-O25', '', '=W$3-T25', '=ROUND((W25*100)/T25,1)&" %"', '=$A25'],
    
    ['ПА', 'Помощник архитектора', 25586.18, '=C26*0.87', '', '=C26*1.055', '=F26*0.87', '=G26-D26', '', 
     '=F26*1.055', '=J26*0.87', '=K26-G26', '', '=J26*1.055', '=N26*0.87', '=O26-K26', '=O26*12', '', 
     '=N26*1.055', '=S26*0.87', '=T26-O26', '', '=W$3-T26', '=ROUND((W26*100)/T26,1)&" %"', '=$A26'],
    
    ['А 1', 'Архитектор 1 категории', 88505.75, '=C27*0.87', '', '=C27*1.055', '=F27*0.87', '=G27-D27', '', 
     '=F27*1.055', '=J27*0.87', '=K27-G27', '', '=J27*1.055', '=N27*0.87', '=O27-K27', '=O27*12', '', 
     '=N27*1.055', '=S27*0.87', '=T27-O27', '', '=W$3-T27', '=ROUND((W27*100)/T27,1)&" %"', '=$A27'],
    
    ['', '', np.nan, np.nan, '', np.nan, np.nan, np.nan, '', 
     np.nan, np.nan, np.nan, '', np.nan, np.nan, np.nan, np.nan, '', 
     np.nan, np.nan, np.nan, '', np.nan, np.nan, np.nan],
    
    ['РО', 'Руководитель отдела', 100000, '=C29*0.87', '', '=C29*1.055', '=F29*0.87', '=G29-D29', '', 
     '=F29*1.055', '=J29*0.87', '=K29-G29', '', '=J29*1.055', '=N29*0.87', '=O29-K29', '=O29*12', '', 
     '=N29*1.055', '=S29*0.87', '=T29-O29', '', '=W$3-T29', '=ROUND((W29*100)/T29,1)&" %"', '=$A29'],
    
    ['ВИП 2', 'Ведущий инженер проектировщик 2 категории', 76760.88, '=C30*0.87', '', '=C30*1.055', '=F30*0.87', '=G30-D30', '', 
     '=F30*1.055', '=J30*0.87', '=K30-G30', '', '=J30*1.055', '=N30*0.87', '=O30-K30', '=O30*12', '', 
     '=N30*1.055', '=S30*0.87', '=T30-O30', '', '=W$3-T30', '=ROUND((W30*100)/T30,1)&" %"', '=$A30'],
    
    ['ИП 1', 'Инженер проектировщик 1 категории', 88505.75, '=C31*0.87', '', '=C31*1.055', '=F31*0.87', '=G31-D31', '', 
     '=F31*1.055', '=J31*0.87', '=K31-G31', '', '=J31*1.055', '=N31*0.87', '=O31-K31', '=O31*12', '', 
     '=N31*1.055', '=S31*0.87', '=T31-O31', '', '=W$3-T31', '=ROUND((W31*100)/T31,1)&" %"', '=$A31'],
    
    ['ВИП 1', 'Ведущий инженер проектировщик 1 категории', 100000, '=C32*0.87', '', '=C32*1.055', '=F32*0.87', '=G32-D32', '', 
     '=F32*1.055', '=J32*0.87', '=K32-G32', '', '=J32*1.055', '=N32*0.87', '=O32-K32', '=O32*12', '', 
     '=N32*1.055', '=S32*0.87', '=T32-O32', '', '=W$3-T32', '=ROUND((W32*100)/T32,1)&" %"', '=$A32'],
]

# Заполняем DataFrame данными
for i, row_data in enumerate(data_rows):
    df.iloc[4 + i, 0:len(row_data)] = row_data

# Очищаем лишние строки (NaN заменяем на пустые строки)
df = df.fillna('')

# Устанавливаем правильные индексы (как в Excel, начиная с 1)
df.index = range(1, len(df) + 1)

# Переименовываем колонки
df.columns = [chr(65 + i) for i in range(25)]

# Выводим DataFrame
print("DataFrame создан. Размер:", df.shape)
print("\nПервые 10 строк:")
print(df.head(10))

# Сохраняем в Excel (с формулами как строками)
output_file = 'ЗП_факт_прогноз_реплика.xlsx'
df.to_excel(output_file, index=False)
print(f"\nDataFrame сохранен в файл: {output_file}")

# Показываем структуру
print("\nСтруктура DataFrame:")
print(df.info())
